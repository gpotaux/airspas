
<%# Top index  %>
<div class="container">
  <div class="top_index">
    <div class="d-flex justify-content-around">
      <div>
        <h4>Trouvez le spa de vos rêves</h4>
        <p>Parmis les plus beaux jacuzzis, hammams et saunas, partout en France !</p>
        <div class="filter">
          <h5> Filtres </h5>
          <ul>
            <%= link_to spas_path(query: params[:query], category: "Hammam") do %>
              <li class="filter_button <%= "active" if params[:category] == "Hammam" %>">Hammam</li>
            <% end %>
            <%= link_to spas_path(query: params[:query], category: "Sauna") do %>
              <li class="filter_button <%= "active" if params[:category] == "Sauna" %>">Sauna</li>
            <% end %>
            <%= link_to spas_path(query: params[:query], category: "Jacuzzi") do %>
              <li class="filter_button <%= "active" if params[:category] == "Jacuzzi" %>">Jacuzzi</li>
            <% end %>
            <%= link_to spas_path do %>
              <li class="filter_button">Reset</li>
            <% end %>
          </ul>
        </div>
        <div class="info">
          <img src="https://cdn-icons-png.flaticon.com/512/665/665049.png" alt="pictogramme-information">
          <span>Plus de <%= @spas.length %> spas disponibles dans votre selection !</span>
        </div>
      </div>
      <div>
        <div class="research_tab">
          <div class="research_symbol"> <img src="https://cdn-icons-png.flaticon.com/512/7472/7472700.png" alt="research_pin_symbol"> </div>
            <%= form_with url: spas_path, method: :get, class: "d-flex" do %>
              <%= text_field_tag :query,
                params[:query],
                class: "form-control",
                placeholder: "Trouvez un spa"
              %>
              <% request.params.slice("category").each do |key, value| %>
                <%= hidden_field_tag key, value %>
              <% end %>
              <%= submit_tag "Search", class: "btn btn-secondary" %>
            <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between">
    <article>
      <h4>La selection <%= link_to "+", new_spa_path if policy(Spa).new? %></h4>
      <div class="grid">
        <% @spas.each do |spa| %>
          <div class="card-selection">
            <%= link_to spa_path(spa) do %>
              <%= cl_image_tag spa.photo.key, crop: :fill %>
              <h5><%= spa.name %></h5>
              <p>A partir de <strong><%= spa.price_per_hour %> EUR</strong></p>
              <p>
              <% if spa.reviews.count.positive? %>
                <div class="stars-black">
                  <i class="fa-sharp fa-solid fa-star"></i>
                  <i class="fa-sharp fa-solid fa-star"></i>
                  <i class="fa-sharp fa-solid fa-star"></i>
                  <i class="fa-sharp fa-solid fa-star"></i>
                  <i class="fa-sharp fa-solid fa-star"></i>
                  <div class="stars-gold" style="width: <%= spa.average_rating/5*100 %>%">
                    <i class="fa-sharp fa-solid fa-star"></i>
                    <i class="fa-sharp fa-solid fa-star"></i>
                    <i class="fa-sharp fa-solid fa-star"></i>
                    <i class="fa-sharp fa-solid fa-star"></i>
                    <i class="fa-sharp fa-solid fa-star"></i>
                  </div>
                </div>
                <%= spa.average_rating.round(1) %>
                <% end %>
              </p>
            <% end %>
          </div>
        <% end %>
      </div>
    </article>

    <aside>
      <div class="d-flex justify-content-between aside_title">
        <h4>Les plus populaires</h4>
        <h4>&#9733;</h4>
      </div>
      <div class="aside_grid">
        <div class="card-aside">
          <a href="#">
            <img src="https://img.freepik.com/photos-premium/arrangement-spa-serviette-du-savon-du-sel_23-2148268482.jpg?w=2000">
            <div class="description">
              <div>
                <h4>Jaccuzzi Le soleil du matin</h4>
                <p>A partir de <strong>128€</strong></p>
              </div>
            </div>
          </a>
        </div>
        <div class="card-aside">
          <a href="#">
            <img src="https://www.thalassopornic.com/upload/media/page/0001/02/7919a4483f0600d3f0fe535a05676fda8581a561.jpeg">
            <div class="description">
              <div>
                <h4>Hammam Au coeur de l'eau</h4>
                <p>A partir de <strong>71€</strong></p>
              </div>
            </div>
          </a>
        </div>
        <div class="card-aside">
          <a href="#">
            <img src="https://www.samm-honfleur.com/gallery/20210607152738.jpg">
            <div class="description">
              <div>
                <h4>Spa Tout Bleu et Blanc</h4>
                <p>A partir de <strong>68€</strong></p>
              </div>
            </div>
          </a>
        </div>
			</div>
    </aside>
  </div>
</div>
<div style="width: 100%; height: 600px;"
  data-controller="map"
  data-map-markers-value="<%= @markers.to_json %>"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
